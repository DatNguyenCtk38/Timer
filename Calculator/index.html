<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Rarity Point Calculator</title>

<style>
body {
  font-family: Arial, sans-serif;
  background: #0f1115;
  color: #eaeaea;
  padding: 20px;
}

h2 {
  margin-bottom: 12px;
}

table {
  border-collapse: collapse;
  width: 100%;
  max-width: 900px;
  background: #161a22;
}

th, td {
  border: 1px solid #2a2f3a;
  padding: 8px;
  text-align: center;
}

th {
  background: #1f2430;
}

input {
  width: 60px;
  padding: 4px;
  text-align: center;
  background: #0f1115;
  color: #fff;
  border: 1px solid #2a2f3a;
  border-radius: 4px;
  transition: all .15s ease;
}

input:focus {
  outline: none;
  border-color: #5dade2;
  box-shadow: 0 0 0 2px rgba(93,173,226,.25);
  background: #12151c;
}

input.filled {
  border-color: #6c7ae0;
  background: #151a28;
}

.total {
  margin-top: 16px;
  font-size: 20px;
  font-weight: bold;
}

/* ===== Rarity colors ===== */
.COMMON { color: #b0b0b0; }
.RARE { color: #2ecc71; }
.EPIC { color: #9b59b6; }
.LEGEND { color: #f1c40f; }
.MYTHIC { color: #e74c3c; }
.MYTHIC_FISH { color: #ff7675; }

/* ===== Background rows ===== */
tr.bg-COMMON { background: #161a22; }
tr.bg-RARE { background: rgba(46,204,113,.08); }
tr.bg-EPIC { background: rgba(155,89,182,.10); }
tr.bg-LEGEND { background: rgba(241,196,15,.12); }
tr.bg-MYTHIC { background: rgba(231,76,60,.14); }
tr.bg-MYTHIC_FISH { background: rgba(255,118,117,.18); }

/* ===== Button ===== */
button {
  margin-top: 12px;
  padding: 8px 16px;
  background: #2d6cdf;
  border: none;
  border-radius: 6px;
  color: #fff;
  cursor: pointer;
}

button:hover {
  background: #3d7eff;
}

/* ===== Preview ===== */
.preview {
  margin-top: 16px;
  max-width: 900px;
  border: 1px solid #2a2f3a;
  border-radius: 8px;
  padding: 12px;
  background: #12151c;
  white-space: pre-line;
  font-size: 14px;
  line-height: 1.6;
}

.preview[contenteditable="true"] {
  outline: 1px dashed #5dade2;
}

/* ===== Toast ===== */
.toast {
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%) scale(0.95);
  background: #1f2430;
  color: #fff;
  padding: 12px 20px;
  border-radius: 8px;
  font-size: 14px;
  opacity: 0;
  transition: all .25s ease;
  z-index: 9999;
}

.toast.show {
  opacity: 1;
  transform: translate(-50%, -50%) scale(1);
}
</style>
</head>

<body>

<h2>ðŸŽ¯ Rarity Point Calculator</h2>

<table>
<thead>
<tr>
  <th>Rarity</th>
  <th>1â˜…</th>
  <th>2â˜…</th>
  <th>3â˜…</th>
</tr>
</thead>
<tbody id="table-body"></tbody>
</table>

<div class="total">
  Total Points: <span id="totalPoint">0</span>
</div>

<div id="previewBox" class="preview"
     contenteditable="false"
     oninput="onPreviewEdit()">
  <i style="opacity:.6">Result preview will appear here...</i>
</div>

<button onclick="copyResult()">ðŸ“‹ Copy Result</button>

<div id="toast" class="toast">Copied to clipboard!</div>

<script>
/* ===== Elite config ===== */
let isElite = true;
let isPreviewEdited = false;

/* ===== Point table (0â˜… REMOVED) ===== */
const pointTable = {
  COMMON:       [15, 30, 90],
  RARE:         [45, 90, 270],
  EPIC:         [75, 150, 450],
  LEGEND:       [150, 300, 900],
  MYTHIC:       [450, 900, 2700],
  MYTHIC_FISH:  [1350, 2400, 8100]
};

const starLabels = ["1â˜…", "2â˜…", "3â˜…"];
const tableBody = document.getElementById("table-body");

/* ===== Build table ===== */
Object.keys(pointTable).forEach(rarity => {
  const row = document.createElement("tr");
  row.className = `bg-${rarity}`;
  row.innerHTML = `
    <td class="${rarity}">
      <b>${rarity.replace("_", " ")}</b>
    </td>
    ${pointTable[rarity].map((_, i) => `
      <td>
        <input type="number" min="0" placeholder="-"
          data-rarity="${rarity}"
          data-star="${i}"
          oninput="calculate()">
      </td>
    `).join("")}
  `;
  tableBody.appendChild(row);
});

/* ===== Calculate ===== */
function calculate() {
  let total = 0;

  document.querySelectorAll("input").forEach(input => {
    const qty = Number(input.value) || 0;
    input.classList.toggle("filled", qty > 0);
    total += qty * pointTable[input.dataset.rarity][input.dataset.star];
  });

  document.getElementById("totalPoint").innerText = total;

  isPreviewEdited = false;
  updatePreview();
}

/* ===== Preview edit detect ===== */
function onPreviewEdit() {
  if (!isElite) return;
  isPreviewEdited = true;
}

/* ===== Build preview ===== */
function updatePreview() {
  const preview = document.getElementById("previewBox");
  preview.contentEditable = isElite;

  if (isElite && isPreviewEdited) return;

  let lines = [];
  let rarityCount = {
    MYTHIC_FISH: 0,
    MYTHIC: 0,
    LEGEND: 0,
    EPIC: 0,
    RARE: 0,
    COMMON: 0
  };

  let totalItems = 0;

  document.querySelectorAll("input").forEach(input => {
    const qty = Number(input.value) || 0;
    if (!qty) return;

    const rarity = input.dataset.rarity;
    const star = starLabels[input.dataset.star];

    rarityCount[rarity] += qty;
    totalItems += qty;

    lines.push(
      `<span class="${rarity}">${rarity.replace("_", " ")}</span> Material ${star} : <b>${qty}</b>`
    );
  });

  if (totalItems === 0) {
    preview.innerHTML =
      `<i style="opacity:.6">Result preview will appear here...</i>`;
    return;
  }

  const summary = Object.entries(rarityCount)
    .filter(([_, count]) => count > 0)
    .map(([rarity, count]) =>
      `<b>${count}</b> <span class="${rarity}">${rarity.replace("_", " ")}</span>`
    )
    .join(" ");

  preview.innerHTML = `
    <b>Number of items sent :</b> ${totalItems} (${summary})<br><br>
    ${lines.join("<br>")}<br><br>
    <b>Total Points :</b> ${document.getElementById("totalPoint").innerText}
  `;
}

/* ===== Copy ===== */
function copyResult() {
  const text = document.getElementById("previewBox").innerText.trim();
  if (!text || text.includes("Result preview")) return;

  navigator.clipboard.writeText(text);
  showToast();
}

/* ===== Toast ===== */
function showToast() {
  const toast = document.getElementById("toast");
  toast.classList.add("show");
  setTimeout(() => toast.classList.remove("show"), 1800);
}
</script>

</body>
</html>
